DROP TABLE TSQLEOD;
DROP TABLE TSQLEODHISTORY;

CREATE TABLE TSQLEOD
(
  HEADERFLAG INTEGER NOT NULL,
  SQL BLOB SUB_TYPE 100 SEGMENT SIZE 80 NOT NULL,
  URUTAN INTEGER NOT NULL,
  TANGGAL TIMESTAMP NOT NULL,
  UNITID INTEGER NOT NULL
);

CREATE TABLE TSQLEODHISTORY
(
  HEADERFLAG INTEGER NOT NULL,
  SQL BLOB SUB_TYPE 100 SEGMENT SIZE 80 NOT NULL,
  URUTAN INTEGER NOT NULL,
  UNITID INTEGER NOT NULL,
  THOTRANSFEREOD_ID VARCHAR(30) NOT NULL
);

DELETE FROM TRANSAKSI_RETUR_NOTA;
DELETE FROM TRANSAKSI_DETIL;
DELETE FROM TRANSAKSI_CARD;
DELETE FROM VOUCHER_LAIN_LAIN;
DELETE FROM TRANSAKSI;
DELETE FROM WASTAGE_REAL;
DELETE FROM UNIT_LEAD_TIME;
DELETE FROM ULINK_PRD;
DELETE FROM TSTOREIMPORT_ITEM;
DELETE FROM TSTOREIMPORT;
DELETE FROM TSOTRANSFERSQL;
DELETE FROM TPOTONGANFAKTURITEM;
DELETE FROM THOTRANSFERSQL;
DELETE FROM THOIMPORT;
DELETE FROM TEMP_LAPORAN;
DELETE FROM TEAM_SOP;
DELETE FROM BARCODE_REQUEST_DETIL;
DELETE FROM BARCODE_REQUEST;
DELETE FROM SUPPLIER_UNIT_LEAD_TIME;
DELETE FROM CUSTOMER;
DELETE FROM SUPLIER_MERCHAN_GRUP;
DELETE FROM CLAIM;
DELETE FROM SUPLIER_GROUP;
DELETE FROM SUPLIER;
DELETE FROM SO;
DELETE FROM SHIPMENT_TRANSPORT;
DELETE FROM SHIPMENT_AGENT;
DELETE FROM SETUPPOS;
DELETE FROM REKENING_PL;
DELETE FROM GROUP_USER_MERCHANDISE;
DELETE FROM REF$DISC_MEMBER;
DELETE FROM REF$SATUAN_NBD;
DELETE FROM REF$HARI_LIBUR;
DELETE FROM PKM_AVERAGE;
DELETE FROM PERIODE_SOP;
DELETE FROM PERIODE_AKUNTANSI;
DELETE FROM MEMBER_ACTIVASI;
DELETE FROM GUDANG;
DELETE FROM DLINK_PRD;
DELETE FROM BARANG_STOK_SIRKULASI;

UPDATE SYS$PARAMETER 
SET PAR_VALUE = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051') WHERE PAR_NAME = 'UNITID';
UPDATE BARANG_HARGA_JUAL 
SET BHJ_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), BHJ_TPHRG_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051');

INSERT INTO SHIFT (SHIFT_ID, SHIFT_UNT_ID, SHIFT_NAME, SHIFT_START_TIME, SHIFT_END_TIME, 
OP_CREATE, DATE_CREATE, OP_MODIFY, DATE_MODIFY, OPC_UNIT, OPM_UNIT)
SELECT SHIFT_ID, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), SHIFT_NAME, SHIFT_START_TIME, SHIFT_END_TIME, 
OP_CREATE, DATE_CREATE, OP_MODIFY, DATE_MODIFY, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051') 
FROM SHIFT WHERE SHIFT_UNT_ID = 52;

INSERT INTO MEMBER (MEMBER_ID, MEMBER_UNT_ID, MEMBER_CARD_NO, MEMBER_NAME, MEMBER_IS_WNI, MEMBER_PLACE_OF_BIRTH, MEMBER_DATE_OF_BIRTH, MEMBER_KTP_NO, MEMBER_SEX, MEMBER_AGAMA_ID, MEMBER_ADDRESS, MEMBER_KELURAHAN, MEMBER_KECAMATAN, MEMBER_KOTA, MEMBER_RT, MEMBER_RW, MEMBER_POST_CODE, MEMBER_JML_TANGGUNGAN, MEMBER_PENDAPATAN, MEMBER_TELP, MEMBER_IS_MARRIED, MEMBER_IS_MAIN, MEMBER_REGISTERED_DATE, MEMBER_GROMEMBER_ID, MEMBER_GROMEMBER_UNT_ID, MEMBER_IS_VALID, MEMBER_IS_ACTIVE, MEMBER_TPMEMBER_ID, OP_CREATE, DATE_CREATE, OP_MODIFY, DATE_MODIFY, OPC_UNIT, OPM_UNIT)
SELECT MEMBER_ID, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), MEMBER_CARD_NO, MEMBER_NAME, MEMBER_IS_WNI, MEMBER_PLACE_OF_BIRTH, MEMBER_DATE_OF_BIRTH, MEMBER_KTP_NO, MEMBER_SEX, MEMBER_AGAMA_ID, MEMBER_ADDRESS, MEMBER_KELURAHAN, MEMBER_KECAMATAN, MEMBER_KOTA, MEMBER_RT, MEMBER_RW, MEMBER_POST_CODE, MEMBER_JML_TANGGUNGAN, MEMBER_PENDAPATAN, MEMBER_TELP, MEMBER_IS_MARRIED, MEMBER_IS_MAIN, MEMBER_REGISTERED_DATE, MEMBER_GROMEMBER_ID, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), MEMBER_IS_VALID, MEMBER_IS_ACTIVE, MEMBER_TPMEMBER_ID, OP_CREATE, DATE_CREATE, OP_MODIFY, DATE_MODIFY, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051') FROM MEMBER WHERE MEMBER_UNT_ID = 52;

INSERT INTO AUT$GROUP (GRO_ID, GRO_UNT_ID, GRO_NAME, GRO_DESCRIPTION) 
VALUES (10, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 'OPERATOR POS', 'Operator Pos');
INSERT INTO AUT$GROUP (GRO_ID, GRO_UNT_ID, GRO_NAME, GRO_DESCRIPTION) 
VALUES (11, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 'SUPERVISOR POS', 'SUPERVISOR POS');
INSERT INTO AUT$GROUP (GRO_ID, GRO_UNT_ID, GRO_NAME, GRO_DESCRIPTION) 
VALUES (25, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 'ADMIN', 'Admin Store');

INSERT INTO AUT$USER (USR_ID, USR_UNT_ID, USR_FULLNAME, USR_USERNAME, USR_PASSWD, USR_STATUS)
VALUES (33, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 'Admin Store', 'store', '', 1);

INSERT INTO AUT$USER_GROUP (UG_USR_ID, UG_USR_UNT_ID, UG_GRO_ID, UG_GRO_UNT_ID) 
VALUES (33, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 25, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'));

INSERT INTO AUT$MODULE (MOD_ID, MOD_UNT_ID, MOD_NAME, MOD_CAPTION, MOD_LABEL, MOD_ACTION, MOD_ICON_PATH)
SELECT MOD_ID, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), MOD_NAME, MOD_CAPTION, MOD_LABEL, MOD_ACTION, MOD_ICON_PATH
FROM AUT$MODULE WHERE MOD_UNT_ID = 52;

INSERT INTO AUT$MENU_STRUCTURE (MENUS_ID, MENUS_UNT_ID, MENUS_NAME, MENUS_CAPTION, MENUS_MOD_ID, MENUS_MOD_UNT_ID, MENUS_PARENT_MENU_ID, MENUS_PARENT_UNT_ID, MENUS_NO)
SELECT
MENUS_ID,
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'),
MENUS_NAME,
MENUS_CAPTION,
MENUS_MOD_ID,
MENUS_MOD_UNT_ID,
MENUS_PARENT_MENU_ID,
MENUS_PARENT_UNT_ID,
MENUS_NO
FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID IS NULL
AND MENUS_PARENT_UNT_ID IS NULL;

INSERT INTO AUT$MENU_STRUCTURE (MENUS_ID, MENUS_UNT_ID, MENUS_NAME, MENUS_CAPTION, MENUS_MOD_ID, MENUS_MOD_UNT_ID, MENUS_PARENT_MENU_ID, MENUS_PARENT_UNT_ID, MENUS_NO)
SELECT
MENUS_ID,
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'),
MENUS_NAME,
MENUS_CAPTION,
MENUS_MOD_ID,
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'),
MENUS_PARENT_MENU_ID,
MENUS_PARENT_UNT_ID,
MENUS_NO
FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID = 52
AND MENUS_PARENT_UNT_ID IS NULL;

INSERT INTO AUT$MENU_STRUCTURE (MENUS_ID, MENUS_UNT_ID, MENUS_NAME, MENUS_CAPTION, MENUS_MOD_ID, MENUS_MOD_UNT_ID, MENUS_PARENT_MENU_ID, MENUS_PARENT_UNT_ID, MENUS_NO)
SELECT
MENUS_ID,
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 
MENUS_NAME, 
MENUS_CAPTION, 
MENUS_MOD_ID, 
MENUS_MOD_UNT_ID, 
MENUS_PARENT_MENU_ID, 
NULL, 
MENUS_NO
FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID IS NULL
AND MENUS_PARENT_UNT_ID = 52;

INSERT INTO AUT$MENU_STRUCTURE (MENUS_ID, MENUS_UNT_ID, MENUS_NAME, MENUS_CAPTION, MENUS_MOD_ID, MENUS_MOD_UNT_ID, MENUS_PARENT_MENU_ID, MENUS_PARENT_UNT_ID, MENUS_NO)
SELECT
MENUS_ID,
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 
MENUS_NAME, 
MENUS_CAPTION, 
MENUS_MOD_ID, 
NULL, 
MENUS_PARENT_MENU_ID, 
NULL, 
MENUS_NO
FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID = 52
AND MENUS_PARENT_UNT_ID = 52;

UPDATE AUT$MENU_STRUCTURE SET 
MENUS_MOD_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'),
MENUS_PARENT_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051')
WHERE MENUS_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051')
AND MENUS_ID IN ( SELECT MENUS_ID FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID = 52
AND MENUS_PARENT_UNT_ID = 52);

UPDATE AUT$MENU_STRUCTURE
SET MENUS_PARENT_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051')
WHERE MENUS_UNT_ID = (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051')
AND MENUS_MOD_UNT_ID IS NULL
AND MENUS_ID IN (SELECT MENUS_ID
FROM AUT$MENU_STRUCTURE
WHERE MENUS_UNT_ID = 52
AND MENUS_MOD_UNT_ID IS NULL
AND MENUS_PARENT_UNT_ID = 52);

INSERT INTO AUT$MENU (MENU_ID,  MENU_UNT_ID,  MENU_GRO_ID,  MENU_GRO_UNT_ID) 
SELECT MENU_ID,  (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), MENU_GRO_ID,  (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051') 
FROM AUT$MENU WHERE MENU_UNT_ID = 52 AND MENU_GRO_UNT_ID = 52 AND MENU_GRO_ID IN (10,11,25);

INSERT INTO MEMBER 
(MEMBER_ID, MEMBER_UNT_ID, MEMBER_CARD_NO, MEMBER_NAME, MEMBER_IS_WNI, 
MEMBER_PLACE_OF_BIRTH, MEMBER_DATE_OF_BIRTH, MEMBER_KTP_NO, MEMBER_SEX, 
MEMBER_AGAMA_ID, MEMBER_ADDRESS, MEMBER_KELURAHAN, MEMBER_KECAMATAN, 
MEMBER_KOTA, MEMBER_RT, MEMBER_RW, MEMBER_POST_CODE, MEMBER_JML_TANGGUNGAN, 
MEMBER_PENDAPATAN, MEMBER_TELP, MEMBER_IS_MARRIED, MEMBER_IS_MAIN, 
MEMBER_REGISTERED_DATE, MEMBER_GROMEMBER_ID, MEMBER_GROMEMBER_UNT_ID, 
MEMBER_IS_VALID, MEMBER_IS_ACTIVE, MEMBER_TPMEMBER_ID, OP_CREATE, 
DATE_CREATE, OP_MODIFY, DATE_MODIFY, OPC_UNIT, OPM_UNIT) 
SELECT 
MEMBER_ID, (SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 
MEMBER_CARD_NO, MEMBER_NAME, MEMBER_IS_WNI, 
MEMBER_PLACE_OF_BIRTH, MEMBER_DATE_OF_BIRTH, MEMBER_KTP_NO, MEMBER_SEX, 
MEMBER_AGAMA_ID, MEMBER_ADDRESS, MEMBER_KELURAHAN, MEMBER_KECAMATAN, 
MEMBER_KOTA, MEMBER_RT, MEMBER_RW, MEMBER_POST_CODE, MEMBER_JML_TANGGUNGAN, 
MEMBER_PENDAPATAN, MEMBER_TELP, MEMBER_IS_MARRIED, MEMBER_IS_MAIN, 
CURRENT_TIMESTAMP, MEMBER_GROMEMBER_ID, MEMBER_GROMEMBER_UNT_ID, 
MEMBER_IS_VALID, MEMBER_IS_ACTIVE, MEMBER_TPMEMBER_ID, OP_CREATE, 
CURRENT_TIMESTAMP, OP_MODIFY, CURRENT_TIMESTAMP, 
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051'), 
(SELECT UNT_ID FROM AUT$UNIT WHERE UNT_CODE = 'TB051')
FROM MEMBER WHERE MEMBER_CARD_NO = '00000000001';